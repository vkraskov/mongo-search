{"pageId": "484901810", "title": "(101) Autopilot \u2013 Gather Hardware IDs script", "editors": "Vasiliy Kraskovskiy, Martins Svirksts", "url": "https://wiki.spb.openwaygroup.com/pages/viewpage.action?pageId=484901810", "comments": "", "labels": "", "fuzzy": "The script collects device hardware IDs using Intune Windows Powershell, stores the data in Azure AD, and assists with debugging.", "body": "Following script is used to gather hardware IDs of devices Its loaded into Intune  Devices  Windows  Powershell Script  Autopilot  Grab Hardware IDs Results are stored in Azure AD storage Azure  storage account  owstorageaccount  File Shares  owautopilotfs  Data includes HW IDs as well as logs from devices to help debugging Gather hardware ID 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 ErrorActionPreferenceSilentlyContinue Stop existing transcript StopTranscript  outnull   Define variables Folder  Ctmp log files LogFile  CtmpAutopilotHardwareID_logstxt Result  0 if TestPath Path Folder      GetDate tmp folder exists moving on  else      GetDate Creating tmp folder     mkdir Folder  ErrorActionPreference  Continue Log file location StartTranscript path LogFile append GetDate Transcript started Check if script was run already GetDate Checking if result file exists ResultFile  FolderAutopilotHardwareID_Resulttxt if TestPath Path ResultFile      GetDate Result file exists reading content     Result  GetContent Path ResultFile     Result     if Result eq 1         GetDate Result file contains 1 script was already running exiting         GetDate Script finished stopping         StopTranscript           GetDate Clean up         CopyItem LogFile Destination AutopilotLogsPCnamecsv Force         GetDate Removing PS drive         RemovePSDrive Name Autopilot Force         RemoveItem FolderPCnamecsv         RemoveItem LogFile         return 0              else          GetDate Result file did not contain 1 running script                   else          GetDate resultfile does not exist script needs to run        Creates external share secStringPassword  ConvertToSecureString xxxxxxxxxxxxxxxxxxxxxxxxxxxxx AsPlainText Force shareCredentials  NewObject SystemManagementAutomationPSCredential localhostowautopilotfs secStringPassword GetDate Creating new PS drive NewPSDrive Name Autopilot PSProvider  FileSystem Root owstorageaccountfilecorewindowsnetowautopilotfs Credential shareCredentials  Installs script GetDate Installing required script SetExecutionPolicy RemoteSigned Force Scope Process InstallScript Name GetWindowsAutoPilotInfo Force   GetDate Creataing More variables PCName  envCOMPUTERNAME FolderCloud  AutopilotIDs GetWindowsAutoPilotInfo Online GetDate Creating file with hardware IDs in cloud GetWindowsAutoPilotInfo OutputFile FolderCloudHardwareIDscsv Append creates a file GetDate Creating file with hardware IDs locally GetWindowsAutoPilotInfo OutputFile FolderPCnamecsv creates a file GetDate Script successful writing result file Result  1 SetContent Path ResultFile Value Result GetDate Resultfile created   GetDate Script finished stopping StopTranscript   GetDate Clean up CopyItem LogFile Destination AutopilotLogsPCnamecsv Force GetDate Removing PS drive RemovePSDrive Name Autopilot Force RemoveItem FolderPCnamecsv RemoveItem LogFile return 0 "}
